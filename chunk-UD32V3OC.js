import{a as Ne}from"./chunk-NNMG3HIQ.js";import{a as A}from"./chunk-Q7Y4HCK3.js";import{a as Z,b as J}from"./chunk-RLESQ3DH.js";import{a as Ve}from"./chunk-QIAVNDFQ.js";import{A as v,Aa as re,B as x,Ba as oe,C as _,D as C,E as o,Ea as Me,F as u,Fa as z,Ga as We,H as k,K as M,L as N,M as W,O as l,P as d,Q as ue,R as _e,T as F,U as ye,W as T,X as O,Y as Ee,aa as xe,d as Ce,e as Q,f as de,ga as Ie,h as b,i as S,ka as be,la as ke,m as s,ma as B,n as f,na as R,o as V,oa as j,p as X,pa as D,qa as P,r as h,ra as U,s as w,sa as ee,t as L,ta as te,u as r,ua as $,v as n,va as ie,w as g,wa as ne,x as y,y as E,ya as q,z as I,za as G}from"./chunk-OPC2CE5J.js";var ae=class{constructor(t,e){this.id=t,this.name=e}id;name};var H=class a{constructor(t,e){this.http=t;this.constService=e;this.BASE_URL=e.FULL_URL+"/weapon"}BASE_URL;getAllWeapons(){let t=this.BASE_URL;return this.http.get(t)}saveWeapons(t){let e=[];for(let i of t){let p=`${i.id}+${i.name}`;e.push(p)}localStorage.setItem("weapons",e.join("###"))}getWeapons(){let t=localStorage.getItem("weapons")||"";if(!t)return[];let e=[],i=t.split("###");for(let p of i){let m=p.split("+");e.push(new ae(Number(m[0]),m[1]))}return e}static \u0275fac=function(e){return new(e||a)(de(xe),de(ke))};static \u0275prov=Ce({token:a,factory:a.\u0275fac,providedIn:"root"})};function De(a,t){if(a&1&&(r(0,"option",27),o(1),l(2,"titlecase"),l(3,"uppercase"),n()),a&2){let e=t.$implicit;_("value",e.id),s(),k("",d(2,3,e.full_name)," | ",d(3,5,e.abbreviation),"")}}function Ae(a,t){if(a&1&&(r(0,"option",27),o(1),n()),a&2){let e=t.$implicit;_("value",e.id),s(),u(e.nickname)}}function Le(a,t){if(a&1&&(r(0,"option",27),o(1),l(2,"titlecase"),n()),a&2){let e=t.$implicit;_("value",e.id),s(),u(d(2,2,e.name))}}function Pe(a,t){if(a&1&&(r(0,"option",27),o(1),l(2,"titlecase"),l(3,"uppercase"),n()),a&2){let e=t.$implicit;_("value",e.id),s(),k("",d(2,3,e.full_name)," | ",d(3,5,e.abbreviation),"")}}function Ue(a,t){if(a&1&&(r(0,"option",27),o(1),n()),a&2){let e=t.$implicit;_("value",e.id),s(),u(e.nickname)}}function $e(a,t){if(a&1&&(r(0,"option",27),o(1),l(2,"titlecase"),n()),a&2){let e=t.$implicit;_("value",e.id),s(),u(d(2,2,e.name))}}var se=class a{constructor(t,e,i,p,m,c,Be){this.clanService=t;this.swpService=e;this.weaponService=i;this.routeService=p;this.combatService=m;this.authService=c;this.errorService=Be}ngOnDestroy(){this.subscriptions.unsubscribe()}ngOnInit(){this.getClansWithEnabledPlayer()}subscriptions=new j;clans=[];idClan1="";idClan2="";swordplayers1=[];idSwp1=0;swordplayers2=[];idSwp2=0;weapons=[];weapons1=[];weapons2=[];idWeapon1=0;idWeapon2=0;roundsScored1=0;roundsScored2=0;getClansWithEnabledPlayer(){this.clanService.getClansWithEnabledPlayers().subscribe({next:t=>{this.clans=t.data,t.token&&this.authService.updateToken(t.token)},complete:()=>{this.getWeapons()},error:t=>{this.errorService.handler(t)}})}getEnabledSwordplayersByClan(t,e){this.subscriptions.add=this.swpService.getEnabledPlayersByClan(t).subscribe({next:i=>{i.token&&this.authService.updateToken(i.token);let p=this.swpService.sortSwordplayers(i.data);e==1&&(t==this.idClan2&&(this.swordplayers2=this.swordplayers2),this.swordplayers1=p),e==2&&(t==this.idClan1&&(this.swordplayers1=this.swordplayers1),this.swordplayers2=p)},error:i=>{this.errorService.handler(i)}})}getWeapons(){this.weapons=this.weaponService.getWeapons(),this.weapons.length>0?(console.log("deu certo"),this.refreshWeaponsList(1),this.refreshWeaponsList(2)):this.subscriptions.add=this.weaponService.getAllWeapons().subscribe({next:t=>{this.weapons=t.data,t.token&&this.authService.updateToken(t.token)},complete:()=>{this.refreshWeaponsList(1),this.refreshWeaponsList(2),this.weaponService.saveWeapons(this.weapons)},error:t=>{this.errorService.handler(t)}})}refreshWeaponsList(t){t==1&&(this.weapons1=[],this.weapons1=this.weapons),t==2&&(this.weapons2=[],this.weapons2=this.weapons)}getInputClan1(t){this.idClan1=t,this.swordplayers1=[],this.getInputSwordplayer1("0"),this.getEnabledSwordplayersByClan(this.idClan1,1)}getInputClan2(t){this.idClan2=t,this.swordplayers2=[],this.getInputSwordplayer2("0"),this.getEnabledSwordplayersByClan(this.idClan2,2)}getInputSwordplayer1(t){this.idSwp1=Number(t),this.refreshWeaponsList(1)}getInputSwordplayer2(t){this.idSwp2=Number(t),this.refreshWeaponsList(2)}getInputWeapon1(t){this.idWeapon1=Number(t),this.roundsScored1=0}getInputWeapon2(t){this.idWeapon2=Number(t),this.roundsScored2=0}toMenu(){this.routeService.navigate.toMenu()}resetForm(){this.roundsScored1=0,this.roundsScored2=0}newCombat(t,e,i,p,m,c){if(!this.combatService.validateCombat(t,e,i,p,m,c))return;let Re=this.authService.getUserId();this.subscriptions.add=this.combatService.newcombat(t,e,i,p,m,c,Re).subscribe({next:K=>{K.token&&this.authService.updateToken(K.token)},complete:()=>{window.alert("Combate registrado com sucesso"),this.resetForm()},error:K=>{this.errorService.handler(K)}})}static \u0275fac=function(e){return new(e||a)(f(We),f(Z),f(H),f(B),f(A),f(R),f(D))};static \u0275cmp=V({type:a,selectors:[["app-combat-new"]],standalone:!1,decls:57,vars:8,consts:[["clanInput1",""],["swordplayerInput1",""],["weaponInput1",""],["clanInput2",""],["swordplayerInput2",""],["weaponInput2",""],[1,"d-flex","flex-column","align-items-center","justify-content-center"],[1,"bg-dark","bg-opacity-75","border","border-3","border","rounded-3","mb-3","p-3","text-center"],[1,"mb-3"],[1,"bg-dark","bg-opacity-75","border","border-3","rounded-3","mb-3","p-3","text-center"],["action",""],["id","swordplayerDiv1",1,"d-flex","flex-column","justify-content-center","align-itens-center"],["name","clan1","id","clan1",1,"rounded","mb-3","text-center","p-1","fs-6",3,"change"],["value",""],[3,"value",4,"ngFor","ngForOf"],["name","swordplayer1","id","swordplayer1",1,"rounded","mb-3","text-center","p-1","fs-6",3,"change"],["name","weapon1","id","weapon1",1,"rounded","mb-3","text-center","p-1","fs-6",3,"change"],["for","roundsScored1"],["type","number","min","0","max","2","name","roundsScored1",1,"rounded","mb-3","text-center","p-1","fs-6",3,"ngModelChange","ngModel"],["id","swordplayerDiv2",1,"d-flex","flex-column","justify-content-center","align-itens-center"],["name","clan2","id","clan2",1,"rounded","mb-3","text-center","p-1","fs-6",3,"change"],["name","swordplayer2","id","swordplayer2",1,"rounded","mb-3","text-center","p-1","fs-6",3,"change"],["name","weapon2","id","weapon2",1,"rounded","mb-3","text-center","p-1","fs-6",3,"change"],["type","number","min","0","max","2","name","roundsScored2",1,"rounded","mb-3","text-center","p-1","fs-6",3,"ngModelChange","ngModel"],[1,"d-flex","justify-content-around"],[1,"btn","btn-danger",3,"click"],[1,"btn","btn-success",3,"click"],[3,"value"]],template:function(e,i){if(e&1){let p=I();r(0,"div",6)(1,"div",7)(2,"h1",8),o(3,"Registrar combate"),n()(),r(4,"div",9)(5,"form",10)(6,"div",11)(7,"h3"),o(8,"Swordplayer 1"),n(),r(9,"select",12,0),v("change",function(){b(p);let c=C(10);return S(i.getInputClan1(c.value))}),r(11,"option",13),o(12,"Selecione o cl\xE3"),n(),h(13,De,4,7,"option",14),n(),r(14,"select",15,1),v("change",function(){b(p);let c=C(15);return S(i.getInputSwordplayer1(c.value))}),r(16,"option",13),o(17,"Selecione ume swordplayer"),n(),h(18,Ae,2,2,"option",14),n(),r(19,"select",16,2),v("change",function(){b(p);let c=C(20);return S(i.getInputWeapon1(c.value))}),r(21,"option",13),o(22,"Selecione uma classe"),n(),h(23,Le,3,4,"option",14),n(),y(24),r(25,"label",17),o(26,"Rounds ganhos 1"),n(),r(27,"input",18),W("ngModelChange",function(c){return b(p),N(i.roundsScored1,c)||(i.roundsScored1=c),S(c)}),n(),E(),n(),g(28,"hr"),r(29,"div",19)(30,"h3"),o(31,"Swordplayer 2"),n(),r(32,"select",20,3),v("change",function(){b(p);let c=C(33);return S(i.getInputClan2(c.value))}),r(34,"option",13),o(35,"Selecione o cl\xE3"),n(),h(36,Pe,4,7,"option",14),n(),r(37,"select",21,4),v("change",function(){b(p);let c=C(38);return S(i.getInputSwordplayer2(c.value))}),r(39,"option",13),o(40,"Selecione ume swordplayer"),n(),h(41,Ue,2,2,"option",14),n(),r(42,"select",22,5),v("change",function(){b(p);let c=C(43);return S(i.getInputWeapon2(c.value))}),r(44,"option",13),o(45,"Selecione uma classe"),n(),h(46,$e,3,4,"option",14),n(),y(47),r(48,"label",17),o(49,"Rounds ganhos 1"),n(),r(50,"input",23),W("ngModelChange",function(c){return b(p),N(i.roundsScored2,c)||(i.roundsScored2=c),S(c)}),n(),E(),n(),g(51,"hr"),r(52,"div",24)(53,"button",25),v("click",function(){return b(p),S(i.toMenu())}),o(54,"Voltar"),n(),r(55,"button",26),v("click",function(){return b(p),S(i.newCombat(i.idSwp1,i.idWeapon1,i.roundsScored1,i.idSwp2,i.idWeapon2,i.roundsScored2))}),o(56,"Registrar"),n()()()()()}e&2&&(s(13),w("ngForOf",i.clans),s(5),w("ngForOf",i.swordplayers1),s(5),w("ngForOf",i.weapons),s(4),M("ngModel",i.roundsScored1),s(9),w("ngForOf",i.clans),s(5),w("ngForOf",i.swordplayers2),s(5),w("ngForOf",i.weapons),s(4),M("ngModel",i.roundsScored2))},dependencies:[F,ie,q,G,P,ne,U,ee,oe,re,$,te,O,T],encapsulation:2})};function qe(a,t){if(a&1){let e=I();y(0),r(1,"tr")(2,"td"),o(3),l(4,"uppercase"),n(),r(5,"td"),o(6),l(7,"titlecase"),n(),r(8,"td"),o(9),l(10,"titlecase"),n(),r(11,"td"),o(12),n(),r(13,"td",6),o(14),l(15,"titlecase"),n(),r(16,"td",6)(17,"button",7),v("click",function(){let p=b(e).$implicit,m=x();return S(m.toCombatEdit(p.id))}),g(18,"i",8),n()(),r(19,"td",6)(20,"button",9),v("click",function(){let p=b(e).$implicit,m=x();return S(m.deleteCombat(p.id,p.swp1.nickname,p.swp2.nickname))}),g(21,"i",10),n()()(),r(22,"tr")(23,"td"),o(24),l(25,"uppercase"),n(),r(26,"td"),o(27),l(28,"titlecase"),n(),r(29,"td"),o(30),l(31,"titlecase"),n(),r(32,"td"),o(33),n()(),g(34,"br"),E()}if(a&2){let e=t.$implicit;s(3),u(d(4,13,e.swp1.clan.abbreviation)),s(3),u(d(7,15,e.swp1.nickname)),s(3),u(d(10,17,e.weapon1.name)),s(2),L("bg-success",e.roundsScored1-e.roundsScored2>0),s(),u(e.roundsScored1),s(2),u(d(15,19,e.creator)),s(10),u(d(25,21,e.swp2.clan.abbreviation)),s(3),u(d(28,23,e.swp2.nickname)),s(3),u(d(31,25,e.weapon2.name)),s(2),L("bg-success",e.roundsScored2-e.roundsScored1>0),s(),u(e.roundsScored2)}}var pe=class a{constructor(t,e,i,p){this.combatServ=t;this.routeService=e;this.authService=i;this.errorService=p}subscriptions=new j;combats=[];ngOnInit(){this.refreshData()}ngOnDestroy(){this.subscriptions.unsubscribe()}getCombats(){this.subscriptions.add=this.combatServ.getAllCombats().subscribe({next:t=>{this.combats=t.data,t.token&&this.authService.updateToken(t.token)},error:t=>{this.errorService.handler(t)}})}deleteCombat(t,e,i){window.confirm(`Remover combate entre ${e} e ${i}?`)&&(this.subscriptions.add=this.combatServ.deleteCombat(t).subscribe({complete:()=>{window.alert("Combate removido")},error:m=>{this.errorService.handler(m)}}))}toCombatEdit(t){this.routeService.navigate.toCombatEdit(t)}refreshData(){this.getCombats()}static \u0275fac=function(e){return new(e||a)(f(A),f(B),f(R),f(D))};static \u0275cmp=V({type:a,selectors:[["app-combat-list"]],standalone:!1,decls:22,vars:1,consts:[[1,"d-flex","justify-content-around","my-3"],[3,"refreshData"],[1,"table","table-striped","table-bordered","text-center","table-sm"],["colspan","1",1,"fs-4","align-middle"],["colspan","2",1,"fs-4","align-middle"],[4,"ngFor","ngForOf"],["rowspan","2",1,"align-middle"],[1,"btn","btn-primary",3,"click"],[1,"bi","bi-pencil-square"],[1,"btn","btn-outline-danger",3,"click"],[1,"bi","bi-trash-fill"]],template:function(e,i){e&1&&(r(0,"div",0),g(1,"app-button-back-to-menu"),r(2,"app-button-refresh-data",1),v("refreshData",function(){return i.refreshData()}),n()(),r(3,"table",2)(4,"thead")(5,"tr")(6,"th",3),o(7,"Cl\xE3"),n(),r(8,"th",3),o(9,"Swp"),n(),r(10,"th",3),o(11,"Classe"),n(),r(12,"th",3),o(13,"Rounds"),n(),r(14,"th",3),o(15,"Registrado"),g(16,"br"),o(17,"por"),n(),r(18,"th",4),o(19,"A\xE7\xF5es"),n()()(),r(20,"tbody"),h(21,qe,35,27,"ng-container",5),n()()),e&2&&(s(21),w("ngForOf",i.combats))},dependencies:[F,Ve,Me,O,T],encapsulation:2})};function Ge(a,t){if(a&1&&(r(0,"option",26),o(1),l(2,"titlecase"),n()),a&2){let e=t.$implicit,i=x();_("value",e.id),w("selected",e.id==i.combat.weapon1.id),s(),u(d(2,3,e.name))}}function He(a,t){if(a&1&&(r(0,"option",26),o(1),l(2,"titlecase"),n()),a&2){let e=t.$implicit,i=x();_("value",e.id),w("selected",e.id==i.combat.weapon2.id),s(),u(d(2,3,e.name))}}var ce=class a{constructor(t,e,i,p,m,c){this.weaponService=t;this.routeService=e;this.combatService=i;this.route=p;this.authService=m;this.errorService=c}ngOnDestroy(){this.subscriptions.unsubscribe()}ngOnInit(){this.idCombat=this.route.snapshot.params.id,this.getCombatById(this.idCombat),this.getWeapons()}subscriptions=new j;idCombat;combat;weapons=[];weapons1=[];weapons2=[];getCombatById(t){this.subscriptions.add=this.combatService.getCombatById(t).subscribe({next:e=>{this.combat=e.data,e.token&&this.authService.updateToken(e.token)},error:e=>{this.errorService.handler(e)}})}getInputWeapon1(t){this.combat.weapon1.id=Number(t)}getInputWeapon2(t){this.combat.weapon2.id=Number(t)}getWeapons(){this.subscriptions.add=this.weaponService.getAllWeapons().subscribe({next:t=>{this.weapons=t.data,t.token&&this.authService.updateToken(t.token)},error:t=>{this.errorService.handler(t)}})}updateCombat(){if(!this.combat)return window.alert("N\xE3o foi identificado combate");if(!this.combat.swp1||!this.combat.swp1)return window.alert("N\xE3o h\xE1 swordplayers registrados no combate");this.combatService.validateCombat(1,this.combat.weapon1.id,this.combat.roundsScored1,2,this.combat.weapon2.id,this.combat.roundsScored2)&&(this.subscriptions.add=this.combatService.updateCombat(this.idCombat,this.combat.weapon1.id,this.combat.weapon2.id,this.combat.roundsScored1,this.combat.roundsScored2,this.authService.getUserId()).subscribe({complete:()=>this.toCombatsList(),error:e=>{this.errorService.handler(e)}}))}toCombatsList(){this.routeService.navigate.toCombatSearch()}static \u0275fac=function(e){return new(e||a)(f(H),f(B),f(A),f(Ie),f(R),f(D))};static \u0275cmp=V({type:a,selectors:[["app-combat-edit"]],standalone:!1,decls:59,vars:23,consts:[["clanInput1",""],["swordplayerInput1",""],["weaponInput1",""],["clanInput2",""],["swordplayerInput2",""],["weaponInput2",""],[1,"d-flex","flex-column","align-items-center","justify-content-center"],[1,"bg-dark","bg-opacity-75","border","border-3","border","rounded-3","mb-3","p-3","text-center"],[1,"mb-3"],[1,"bg-dark","bg-opacity-75","border","border-3","rounded-3","mb-3","p-3","text-center"],["action",""],["id","swordplayerDiv1",1,"d-flex","flex-column","justify-content-center","align-itens-center"],["disabled","","name","clan1","id","clan1",1,"rounded","mb-3","text-center","p-1","fs-6"],["disabled","","name","swordplayer1","id","swordplayer1",1,"rounded","mb-3","text-center","p-1","fs-6"],["name","weapon1","id","weapon1",1,"rounded","mb-3","text-center","p-1","fs-6",3,"change"],[3,"selected","value",4,"ngFor","ngForOf"],["for","roundsScored1"],["type","number","min","0","max","2","name","roundsScored1",1,"rounded","mb-3","text-center","p-1","fs-6",3,"ngModelChange","ngModel"],["id","swordplayerDiv2",1,"d-flex","flex-column","justify-content-center","align-itens-center"],["disabled","","name","clan2","id","clan2",1,"rounded","mb-3","text-center","p-1","fs-6"],["disabled","","name","swordplayer2","id","swordplayer2",1,"rounded","mb-3","text-center","p-1","fs-6"],["name","weapon2","id","weapon2",1,"rounded","mb-3","text-center","p-1","fs-6",3,"change"],["type","number","min","0","max","2","name","roundsScored2",1,"rounded","mb-3","text-center","p-1","fs-6",3,"ngModelChange","ngModel"],[1,"d-flex","justify-content-around"],[1,"btn","btn-danger",3,"click"],[1,"btn","btn-success",3,"click"],[3,"selected","value"]],template:function(e,i){if(e&1){let p=I();r(0,"div",6)(1,"div",7)(2,"h1",8),o(3,"Editar combate"),n()(),r(4,"div",9)(5,"form",10)(6,"div",11)(7,"h3"),o(8,"Swordplayer 1"),n(),r(9,"select",12,0)(11,"option"),o(12),l(13,"titlecase"),l(14,"uppercase"),n()(),r(15,"select",13,1)(17,"option"),o(18),l(19,"titlecase"),n()(),r(20,"select",14,2),v("change",function(){b(p);let c=C(21);return S(i.getInputWeapon1(c.value))}),h(22,Ge,3,5,"option",15),n(),y(23),r(24,"label",16),o(25,"Rounds ganhos 1"),n(),r(26,"input",17),W("ngModelChange",function(c){return b(p),N(i.combat.roundsScored1,c)||(i.combat.roundsScored1=c),S(c)}),n(),E(),n(),r(27,"div",18)(28,"h3"),o(29,"Swordplayer 2"),n(),r(30,"select",19,3)(32,"option"),o(33),l(34,"titlecase"),l(35,"uppercase"),n()(),r(36,"select",20,4)(38,"option"),o(39),l(40,"titlecase"),n()(),r(41,"select",21,5),v("change",function(){b(p);let c=C(42);return S(i.getInputWeapon2(c.value))}),h(43,He,3,5,"option",15),n(),y(44),r(45,"label",16),o(46,"Rounds ganhos 1"),n(),r(47,"input",22),W("ngModelChange",function(c){return b(p),N(i.combat.roundsScored2,c)||(i.combat.roundsScored2=c),S(c)}),n(),E(),n(),r(48,"div",23)(49,"button",24),v("click",function(){return b(p),S(i.toCombatsList())}),o(50,"Voltar"),n(),r(51,"button",25),v("click",function(){return b(p),S(i.updateCombat())}),o(52,"Atualizar"),n()()(),g(53,"hr"),r(54,"div")(55,"p"),o(56,"Registrado por: "),r(57,"strong"),o(58),n()()()()()}e&2&&(s(12),k("",d(13,11,i.combat.swp1.clan.full_name)," | ",d(14,13,i.combat.swp1.clan.abbreviation),""),s(6),u(d(19,15,i.combat.swp1.nickname)),s(4),w("ngForOf",i.weapons),s(4),M("ngModel",i.combat.roundsScored1),s(7),k("",d(34,17,i.combat.swp2.clan.full_name)," | ",d(35,19,i.combat.swp1.clan.abbreviation),""),s(6),u(d(40,21,i.combat.swp2.nickname)),s(4),w("ngForOf",i.weapons),s(4),M("ngModel",i.combat.roundsScored2),s(11),u(i.combat.creator))},dependencies:[F,ie,q,G,P,ne,U,ee,oe,re,$,te,O,T],encapsulation:2})};function Ye(a,t){if(a&1&&(r(0,"option",19),o(1),l(2,"uppercase"),l(3,"titlecase"),n()),a&2){let e=t.$implicit;_("value",e.id),s(),k("",d(2,3,e.clan.abbreviation)," | ",d(3,5,e.nickname),"")}}function ze(a,t){if(a&1&&(r(0,"option",19),o(1),l(2,"uppercase"),l(3,"titlecase"),n()),a&2){let e=t.$implicit;_("value",e.id),s(),k("",d(2,3,e.clan.abbreviation)," | ",d(3,5,e.nickname),"")}}function Je(a,t){if(a&1){let e=I();y(0),r(1,"div")(2,"table",21)(3,"thead")(4,"tr")(5,"th",22),o(6,"Cl\xE3s"),n(),r(7,"th",22),o(8,"Swordplayers"),n(),r(9,"th",22),o(10,"Armas"),n(),r(11,"th",22),o(12,"Rounds"),n(),r(13,"th",22),o(14,"Registrado"),g(15,"br"),o(16,"por"),n(),r(17,"th",23),o(18,"A\xE7\xF5es"),n()()(),r(19,"tbody")(20,"tr")(21,"td"),o(22),l(23,"uppercase"),n(),r(24,"td"),o(25),l(26,"titlecase"),n(),r(27,"td"),o(28),l(29,"titlecase"),n(),r(30,"td"),o(31),n(),r(32,"td",24),o(33),n(),r(34,"td",24)(35,"button",16),v("click",function(){b(e);let p=x(2);return S(p.toCombatEdit(p.combat.id))}),g(36,"i",25),n()(),r(37,"td",24)(38,"button",26),v("click",function(){b(e);let p=x(2);return S(p.deleteCombat(p.combat.id,p.combat.swp1.nickname,p.combat.swp2.nickname))}),g(39,"i",27),n()()(),r(40,"tr")(41,"td"),o(42),l(43,"uppercase"),n(),r(44,"td"),o(45),l(46,"titlecase"),n(),r(47,"td"),o(48),l(49,"titlecase"),n(),r(50,"td"),o(51),n()()()()(),E()}if(a&2){let e=x(2);s(22),u(d(23,13,e.combat.swp1.clan.abbreviation)),s(3),u(d(26,15,e.combat.swp1.nickname)),s(3),u(d(29,17,e.combat.weapon1.name)),s(2),L("bg-success",e.combat.roundsScored1>e.combat.roundsScored2),s(),u(e.combat.roundsScored1),s(2),u(e.combat.creator),s(9),u(d(43,19,e.combat.swp2.clan.abbreviation)),s(3),u(d(46,21,e.combat.swp2.nickname)),s(3),u(d(49,23,e.combat.weapon2.name)),s(2),L("bg-success",e.combat.roundsScored1<e.combat.roundsScored2),s(),u(e.combat.roundsScored2)}}function Ke(a,t){if(a&1&&(y(0),h(1,Je,52,25,"ng-container",20),E()),a&2){let e=x(),i=C(31);s(),w("ngIf",e.combat&&e.combatFound)("ngIfElse",i)}}function Qe(a,t){a&1&&(r(0,"div",28)(1,"div",5)(2,"div",6)(3,"div",29)(4,"h1",30),o(5,"Combate n\xE3o encontrado"),n()()()()())}var me=class a{constructor(t,e,i,p,m){this.routeService=t;this.combatService=e;this.swpService=i;this.authService=p;this.errorService=m}ngOnDestroy(){this.subscriptions.unsubscribe()}ngOnInit(){this.getSwordplayers()}subscriptions=new j;combatRequested=!1;combatFound=!0;swordplayers=[];swpMap={};combat;swpFilter1="";swpFilter2="";swpId1=0;swpId2=0;getSwordplayers(){this.subscriptions.add=this.swpService.getAllSwordplayers().subscribe({next:t=>this.swordplayers=t.data,complete:()=>this.swpMap=this.swpService.mapSwordplayers(this.swordplayers),error:t=>{this.errorService.handler(t)}})}getSwp1(t){this.swpId1=Number(t)}getSwp2(t){this.swpId2=Number(t)}searchCombat(t,e){if(!t||!e)return window.alert("Por favor, selecione os dois swordplayers");if(t==e)return window.alert("Escolha swordplayers diferentes");this.subscriptions.add=this.combatService.getCombatByBothSwordplayers(t,e).subscribe({next:i=>{i.token&&this.authService.updateToken(i.token),this.combat=i.data},complete:()=>{if(t==this.combat.swp1.id){let i=this.swpMap[t];this.combat.swp1=this.swordplayers[i];let p=this.swpMap[e];this.combat.swp2=this.swordplayers[p]}else{let i=this.swpMap[e];this.combat.swp1=this.swordplayers[i];let p=this.swpMap[t];this.combat.swp2=this.swordplayers[p]}this.combatFound=!0},error:i=>{if(i.status==404){this.combatFound=!1;return}this.errorService.handler(i)}}),this.combatRequested=!0}deleteCombat(t,e,i){window.confirm(`Remover combate entre ${e} e ${i}?`)&&(this.subscriptions.add=this.combatService.deleteCombat(t).subscribe({complete:()=>{window.alert("Combate removido")},error:m=>{if(m.status==404)return window.alert("Combate n\xE3o encontrado");this.errorService.handler(m)}}))}toCombatEdit(t){this.routeService.navigate.toCombatEdit(t)}clearFilter(){this.swpFilter1="",this.swpFilter2=""}static \u0275fac=function(e){return new(e||a)(f(B),f(A),f(Z),f(R),f(D))};static \u0275cmp=V({type:a,selectors:[["app-combat-search"]],standalone:!1,decls:32,vars:11,consts:[["swpInput1",""],["swpInput2",""],["combatNotFound",""],[1,"mb-3","text-center"],[1,"container","border","rounded","m-2","bg-dark","bg-opacity-75"],[1,"row"],[1,"col"],[1,"d-flex","flex-column","justify-content-center","align-itens-center"],["type","text","placeholder","Filtrar cl\xE3 ou swordplayer 1",1,"text-center","form-control","m-1",3,"ngModelChange","ngModel"],["name","swp1","id","swp1",1,"form-select","m-1",3,"change"],["selected","","value","0"],[3,"value",4,"ngFor","ngForOf"],["type","text","placeholder","Filtrar cl\xE3 ou swordplayer 2",1,"text-center","form-control","m-1",3,"ngModelChange","ngModel"],["name","swp2","id","swp2",1,"form-select","m-1",3,"change"],[1,"d-flex","justify-content-around","m-3"],[1,"btn","btn-outline-warning",3,"click"],[1,"btn","btn-primary",3,"click"],[1,"d-flex","justify-content-center"],[4,"ngIf"],[3,"value"],[4,"ngIf","ngIfElse"],[1,"table","table-bordered","text-center"],[1,"allign-middle"],["colspan","2",1,"allign-middle"],["rowspan","2",1,"align-middle"],[1,"bi","bi-pencil-square"],[1,"btn","btn-outline-danger",3,"click"],[1,"bi","bi-trash-fill"],[1,"container","m-2"],[1,"border","rounded","text-center","bg-warning","bg-opacity-75"],[1,"text-dark"]],template:function(e,i){if(e&1){let p=I();r(0,"h1",3),o(1,"Procurar combate"),n(),r(2,"div",4)(3,"div",5)(4,"div",6)(5,"div",7)(6,"input",8),W("ngModelChange",function(c){return b(p),N(i.swpFilter1,c)||(i.swpFilter1=c),S(c)}),n(),r(7,"select",9,0),v("change",function(){b(p);let c=C(8);return S(i.getSwp1(c.value))}),r(9,"option",10),o(10,"SELECIONE UME SWORDPLAYER"),n(),h(11,Ye,4,7,"option",11),l(12,"findSwordplayer"),n()()(),r(13,"div",6)(14,"div",7)(15,"input",12),W("ngModelChange",function(c){return b(p),N(i.swpFilter2,c)||(i.swpFilter2=c),S(c)}),n(),r(16,"select",13,1),v("change",function(){b(p);let c=C(17);return S(i.getSwp2(c.value))}),r(18,"option",10),o(19,"SELECIONE UME SWORDPLAYER"),n(),h(20,ze,4,7,"option",11),l(21,"findSwordplayer"),n()()()(),r(22,"div",5)(23,"div",14)(24,"button",15),v("click",function(){return b(p),S(i.clearFilter())}),o(25,"Limpar filtros"),n(),r(26,"button",16),v("click",function(){return b(p),S(i.searchCombat(i.swpId1,i.swpId2))}),o(27,"Pesquisar"),n()()()(),r(28,"div",17),h(29,Ke,2,2,"ng-container",18)(30,Qe,6,0,"ng-template",null,2,_e),n()}e&2&&(s(6),M("ngModel",i.swpFilter1),s(5),w("ngForOf",ue(12,5,i.swordplayers,i.swpFilter1)),s(4),M("ngModel",i.swpFilter2),s(5),w("ngForOf",ue(21,8,i.swordplayers,i.swpFilter2)),s(9),w("ngIf",i.combatRequested))},dependencies:[F,ye,q,G,P,U,$,O,T,Ne],encapsulation:2})};var Xe=[{path:"new",component:se,canActivate:[z,J]},{path:"list",component:pe,canActivate:[z,J]},{path:"search",component:me,canActivate:[z,J]},{path:"edit/:id",component:ce,canActivate:[z,J]}],le=class a{static \u0275fac=function(e){return new(e||a)};static \u0275mod=X({type:a});static \u0275inj=Q({imports:[be.forChild(Xe),be]})};var Oe=class a{static \u0275fac=function(e){return new(e||a)};static \u0275mod=X({type:a});static \u0275inj=Q({imports:[Ee,le]})};export{Oe as CombatModule};
